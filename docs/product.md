# Pet - 桌面宠物系统产品设计文档

## 1. 产品概述

### 1.1 产品定位

Pet 是一款桌面宠物应用，用户可以通过 AI 生成个性化的 3D 宠物模型，宠物以悬浮窗形式常驻桌面陪伴用户。

### 1.2 核心价值

- **陪伴感**：宠物常驻桌面，提供持续的情感陪伴
- **个性化**：通过 Meshy AI 生成独一无二的宠物形象
- **交互性**：支持拖拽、点击等交互方式

### 1.3 目标用户

- 希望桌面有个性化装饰的用户
- 喜欢虚拟宠物的用户
- 对 AI 生成内容感兴趣的用户

## 2. 功能设计

### 2.1 功能架构

```
┌─────────────────────────────────────────────────────────────┐
│                      Pet 桌面宠物系统                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                 宠物剧场 (核心体验)                   │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │  • 3D 模型渲染        • 行为脚本回放                 │   │
│  │  • 拖拽交互           • 动画效果                     │   │
│  │  • 悬浮窗显示         • 置顶显示                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                           ▲                                 │
│                           │ 系统托盘菜单触发                 │
│                           ▼                                 │
│  ┌───────────────┐   ┌─────────────────────────────────┐   │
│  │   系统托盘    │   │       宠物管理器 (辅助功能)       │   │
│  ├───────────────┤   ├─────────────────────────────────┤   │
│  │ • 显示管理器  │   │  • 创建新宠物                    │   │
│  │ • 退出程序    │   │  • 宠物列表管理                  │   │
│  │ • 快捷操作    │   │  • 设置配置                      │   │
│  └───────────────┘   └─────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 核心功能

#### 2.2.1 宠物剧场（主体功能）

宠物剧场是用户日常看到和交互的主要界面，采用 Replay 架构播放宠物行为。

| 功能项 | 描述 |
|-------|------|
| 悬浮窗显示 | 无边框透明窗口，默认显示在桌面右下角 |
| 3D 渲染 | 渲染 GLB 格式的 3D 模型 |
| 行为回放 | 读取行为脚本，实时回放宠物动作 |
| 拖拽移动 | 支持鼠标拖拽移动到任意位置 |
| 置顶显示 | 始终显示在其他窗口之上 |
| 交互响应 | 点击等交互事件触发新的行为序列 |

#### 2.2.2 系统托盘

系统托盘提供快捷入口，常驻后台运行。

| 功能项 | 描述 |
|-------|------|
| 托盘图标 | 显示应用图标，表示程序运行中 |
| 打开管理器 | 点击打开宠物管理界面 |
| 显示/隐藏宠物 | 快速切换宠物显示状态 |
| 退出程序 | 完全退出应用 |

#### 2.2.3 宠物管理器（辅助功能）

管理器仅在需要时通过托盘菜单打开。

| 功能项 | 描述 |
|-------|------|
| 创建宠物 | 输入描述，通过 Meshy AI 生成 3D 模型 |
| 宠物列表 | 展示已创建的所有宠物 |
| 切换宠物 | 选择要显示的宠物 |
| 删除宠物 | 删除宠物及其模型文件 |
| 宠物命名 | 为宠物设置/修改名称 |
| API 设置 | 配置 Meshy AI API 密钥 |

**宠物创建流程：**

```
托盘菜单 → 打开管理器 → 输入描述 → 提交生成 → 等待处理 → 预览确认 → 保存并显示
```

#### 2.2.4 宠物行为系统

| 状态 | 描述 | 触发条件 |
|------|------|---------|
| Idle | 待机状态，轻微呼吸动画 | 默认状态 |
| Walking | 行走状态，左右移动 | 随机触发 |
| Happy | 开心状态，跳跃动画 | 用户点击 |
| Sleeping | 睡眠状态，闭眼静止 | 长时间无交互 |
| Bounce | 弹跳状态，上下弹跳 | 随机触发 |
| Spin | 旋转状态，原地旋转 | 随机触发 |

**状态转换图：**

```
        ┌──────────────────────────────┐
        │                              │
        ▼                              │
    ┌───────┐   随机    ┌─────────┐   │
    │ Idle  │ ───────► │ Walking │ ──┘
    └───────┘          └─────────┘
        │ │ \
   点击 │ │  └── 随机 ──► ┌────────┐ ──► Idle
        │ │               │ Bounce │
        │ │               └────────┘
        │ └── 随机 ──► ┌──────┐ ──► Idle
        │              │ Spin │
        │              └──────┘
        ▼
    ┌───────┐          ┌───────┐
    │ Happy │ ───────► │ Idle  │
    └───────┘  完成    └───────┘
        
    长时间无交互
        │
        ▼
    ┌──────────┐  任意交互  ┌──────┐
    │ Sleeping │ ─────────►│ Idle │
    └──────────┘           └──────┘
```

## 3. 用户体验流程

### 3.1 首次使用

```
启动应用 → 显示托盘图标 → 自动打开管理器 → 引导创建第一个宠物 → 宠物显示在桌面
```

### 3.2 日常使用

```
开机自启 → 托盘图标常驻 → 宠物自动显示在桌面 → 用户与宠物交互
                              │
                              └─ 需要管理时：托盘菜单 → 打开管理器
```

### 3.3 典型场景

| 场景 | 用户操作 |
|------|---------|
| 日常陪伴 | 宠物在桌面自动运行，偶尔点击互动 |
| 创建新宠物 | 托盘 → 管理器 → 创建 |
| 切换宠物 | 托盘 → 管理器 → 选择其他宠物 |
| 暂时隐藏 | 托盘 → 隐藏宠物 |
| 移动位置 | 直接拖拽宠物悬浮窗 |

## 4. 界面设计

### 4.1 宠物悬浮窗

```
          ┌─────────────┐
          │             │
          │   [3D 模型]  │  ← 无边框透明窗口
          │             │     可拖拽到任意位置
          │     ◠‿◠     │  ← 宠物表情/状态动画
          │             │
          └─────────────┘
               ▲
               │
          默认桌面右下角
```

### 4.2 系统托盘菜单

```
    ┌─────────────────┐
    │ 显示宠物        │
    │ ─────────────── │
    │ 打开管理器      │
    │ ─────────────── │
    │ 退出            │
    └─────────────────┘
```

### 4.3 管理器界面

```
┌────────────────────────────────────────────────────┐
│  Pet 宠物管理                                   [×]│
├────────────────────────────────────────────────────┤
│                                                    │
│  ┌─────────────────────────────────────────────┐  │
│  │              创建新宠物                      │  │
│  │                                             │  │
│  │  描述: [____________________________]       │  │
│  │                                             │  │
│  │                    [生成]                   │  │
│  └─────────────────────────────────────────────┘  │
│                                                    │
│  ─────────────── 我的宠物 ───────────────         │
│                                                    │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐        │
│  │  [预览]  │  │  [预览]  │  │  [预览]  │        │
│  │ 小白兔   │  │ 机器猫   │  │ 小狐狸   │        │
│  │ [使用中] │  │ [切换]   │  │ [切换]   │        │
│  └──────────┘  └──────────┘  └──────────┘        │
│                                                    │
│  ─────────────── 设置 ───────────────            │
│                                                    │
│  API Key: [________________________] [保存]       │
│  [ ] 开机自启动                                   │
│                                                    │
└────────────────────────────────────────────────────┘
```

## 5. 相关文档

- [技术架构文档](architecture.md) - 技术架构、数据模型、依赖清单等
- [开发路线图](roadmap.md) - 详细的开发计划和任务清单
